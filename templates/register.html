{% extends "base.html" %}

{% block title %}Sign Up - SARKAR AI{% endblock %}

{% block content %}
<div class="login-bg">
  <div class="login-center-card">
    <div class="login-logo-container">
      <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="SARKAR AI" class="login-logo">
    </div>
    <div class="login-title">SARKAR AI</div>
    <div class="login-subtitle">Create your account</div>

    <form method="POST" action="{{ url_for('main_routes.register') }}" class="login-form" id="registerForm">
      <input type="text" class="login-input" id="name" name="name" placeholder="Full Name">
      <input type="text" class="login-input" id="username" name="username" placeholder="Username" required>
      <div class="invalid-feedback" id="username-error"></div>
      <input type="email" class="login-input" id="email" name="email" placeholder="Email Address" required>
      <div class="invalid-feedback" id="email-error"></div>
      <div class="login-password-group">
        <input type="password" class="login-input" id="password" name="password" placeholder="Password" required minlength="6">
        <label class="show-password-label">
          <input type="checkbox" onclick="togglePassword('password')"> Show password
        </label>
      </div>
      <div class="invalid-feedback" id="password-error"></div>
      <div class="login-password-group">
        <input type="password" class="login-input" id="confirm_password" name="confirm_password" placeholder="Confirm Password" required minlength="6">
        <label class="show-password-label">
          <input type="checkbox" onclick="togglePassword('confirm_password')"> Show password
        </label>
      </div>
      <div class="invalid-feedback" id="confirm-password-error"></div>
      <button type="submit" class="btn login-btn">Create Account</button>
    </form>
    <div class="login-signup-row">
      <span>Already have an account?</span> <a href="{{ url_for('main_routes.auth') }}" class="login-link">Sign in</a>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function togglePassword(inputId) {
    const input = document.getElementById(inputId);
    
    if (input.type === 'password') {
        input.type = 'text';
    } else {
        input.type = 'password';
    }
}

// Form validation
document.getElementById('registerForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    const username = document.getElementById('username').value.trim();
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirm_password').value;
    
    let isValid = true;
    
    // Clear previous errors
    document.querySelectorAll('.is-invalid').forEach(el => el.classList.remove('is-invalid'));
    
    // Username validation
    if (!username || username.length < 3) {
        document.getElementById('username').classList.add('is-invalid');
        document.getElementById('username-error').textContent = 'Username must be at least 3 characters long';
        isValid = false;
    }
    
    // Email validation
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!email || !emailRegex.test(email)) {
        document.getElementById('email').classList.add('is-invalid');
        document.getElementById('email-error').textContent = 'Please enter a valid email address';
        isValid = false;
    }
    
    // Password validation
    if (!password || password.length < 6) {
        document.getElementById('password').classList.add('is-invalid');
        document.getElementById('password-error').textContent = 'Password must be at least 6 characters long';
        isValid = false;
    }
    
    // Confirm password validation
    if (password !== confirmPassword) {
        document.getElementById('confirm_password').classList.add('is-invalid');
        document.getElementById('confirm-password-error').textContent = 'Passwords do not match';
        isValid = false;
    }
    
    if (isValid) {
        this.submit();
    }
});

// Real-time validation
document.getElementById('confirm_password').addEventListener('input', function() {
    const password = document.getElementById('password').value;
    const confirmPassword = this.value;
    
    if (confirmPassword && password !== confirmPassword) {
        this.classList.add('is-invalid');
        document.getElementById('confirm-password-error').textContent = 'Passwords do not match';
    } else {
        this.classList.remove('is-invalid');
    }
});
</script>
{% endblock %}
